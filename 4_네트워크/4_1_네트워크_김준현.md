# 네트워크의 큰 그림

## 네트워크의 기본 구조

네트워크 : 노드와 간선으로 이루어진 자료구조  -> '그래프'의 형태

네트워크 토폴로지 : 

- 네트워크 상에서 노드와 노드 사이의 연결 구조

- 노드가 어떻게 연결되고 배치되느냐에 다라 유형 나뉨

- 망형, 트리형, 링형, 성형, 버스형(선형) 등

호스트 : 네트워크의 가장자리에 위치하면서 네트워크를 통해 주고받는 정보를 최초로 송신하고 최종 수신하는 노드

- 예시) 노트북의 웹 프라우저를 통해 구글 홈페이지에 접속했다면 노트북과 구글의 서버 컴퓨터가 각각 호스트로서 정보를 주고 받은 것

  - 1) 노트북이 구글의 서버 컴퓨터에게 웹 페이지를 가져다 달라는 요청을 보낸다.

  - 2) 구글의 서버 컴퓨터가 노트북에게 웹 페이지로 응답한다.    

  - 클라이언트 : 노트북처럼 요청을 보내는 호스트
 
  - 서버 : 구글의 서버 컴퓨터처럼 응답을 보내는 호스트
 
중간 노드 : 

- 네트워크를 그래프로 간주했을 때 중간에 위치한 노드

- 가장자리에 위치한 호스트가 주고받는 정보들을 원하는 수신지까지 안정적으로 전송하는 역할

- 중간 노드 역할 수행하는 네트워크 장비 : 스위치, 라우터, 공유기 등

### LAN과 WAN

네트워크는 규모에 따라 LAN과 WAN으로 나뉜다.

LAN (Local Area Network):

- 가정이나 기업처럼 비교적 가까운 거리를 연결하는 한정된 공간에서의 네트워크

- 예) 집, 사무실에 있는 공유기를 통해 모든 네트워크 기기 통신 = LAN이 공유기를 기준으로 구축됨


WAN (Wide Area Network) :

- 인터넷을 가능하게 만드는 네트워크

- 원거리 네트워크를 의미하는 WAN을 통해 LAN간 통신이 이루어진다.

- WAN은 ISP(Internet Service Provider)라는 인터넷 서비스 업체가 구축하고 관리 (KT, LG유플러스, SK브로드밴드)

### 패킷 교환 네트워크

네트워크를 통해 주고받는 데이터는 한 번에 송수신되지 않고, 여러 데이터로 쪼개져서 송수신된다.

- 패킷 : 네트워크를 통해 송수신되는 데이터의 단위

  - 페이로드(payload)와 헤더(header)로 구성됨 + 트레일러(trailer) 라는 정보가 포함되기도 함
 
  - 페이로드 : 패킷에서 송수신하고자 하는 데이터
 
  - 헤더, 트레일러 : 페킷에 추가되는 부가정보

- 패킷 교환 네트워크 : 패킷 단위로 주고받는 정보를 쪼개서 송수신하고 수신지에서 재조립하여 패킷을 주고 받음 -> 오늘날의 네트워크

### 주소의 개념과 전송방식

네트워크 상의 두 호스트가 패킷을 주고받는 상황에서 올바르게 정보를 주고 받으려면 주소가 필요하다.

주소 (address) : 

- 패킷의 헤더에 명시되는 정보

- 예) IP 주소, MAC 주소

주소를 바탕으로 다양한 수신지 유형을 지정해 패킷을 보낼 수 있다.  

수신지를 특정 호스트 하나로 지정 가능하고, 네트워크 내 모든 호스트로도 지정 가능

- **유니캐스트** : 송신지와 수신지가 일대일로 메시지를 방식

- **브로드캐스트** : 네트워크 상의 모든 호스트에게 메시지를 전송하는 방식

  - 브로드캐스트 도메인 : 브로드캐스트가 전송되는 범위
    
  - 호스트가 같은 브로드캐스트 도메인에 속해 있는 경우네는 같은 LAN에 속해 있다고 간주한다.

- 멀티캐스트 : 네트워크 내의 동일 그룹에 속한 호스트에게만 메시지를 전송하는 방식

- 애니캐스트 : 동일 그룹에 속한 호스트 중 가장 가까운 호스트에게 메시지를 전송하는 방식

## 두 호스트가 패킷을 주고 받는 과정

네트워크 내의 호스트는 서로가 주고받을 내용(패킷)을 이해할 수 있어야 하고, 이를 올바르게 주고 받을 수 있어야 한다.

### 프로토콜

프로토콜 : 

- 네트워크에서 통신을 주고받는 노드 간의 합의된 규칙이나 방법

- 패킷을 주고 받는 호스트와 네트워크 장비들이 서로 주고받는 정보를 이해하려면 같은 프로토콜을 이해해야 하고, 같은 프로토콜로 통신해야한다.

- IP : 네트워크 간의 주소를 지정한다는 목적을 가진 프로토콜

- ARP : IP주소와 MAC주소를 대응시킨다는 목적을 지닌 프로토콜

- HTTPS는 보안상 HTTP에 비해 안전하며, TCP는 UDP에 비해 신뢰성이 높다.

### 네트워크 참조 모델

호스트 간에 패킷을 주고받는 과정은 택배를 주고받는 과정과 비슷하다.

패킷을 송신하는 쪽 : 상위계층에서 하위계층으로 정보를 보냄

패킷을 수신하는 쪽 : 하위 계층에서 상위 계층으로 정보를 받아들임

네트워크 참조 모델에서 각각의 계층이 하는 일은 명확하게 정해져있다.

따라서 계층별 목적에 맞는 프로토콜과 장비를 구성하면 네트워크의 구성과 설계, 문제의 진단과 해결이 용이하다.

**OSI 모델**

<img width="746" height="1072" alt="image" src="https://github.com/user-attachments/assets/cd44239b-b16c-41c4-acfa-a2d2b3a37848" />

1. 물리 계층

- 가장 최하위 계층

- 비트 신호를 주고 받는 계층

- 0과 1로 이루어진 신호를 유무선 통신 메체를 통해 운반하는 계층

2. 데이터 링크 계층

- LAN에 속한 호스트끼리 올바르게 정보를 주고받기 위한 계층

- 이를 위해 같은 네트워크에 속한 호스트를 식별할 수 있는 주소(MAC 주소)를 사용하고, 물리 계층을 통해 주고받는 정보에 오류가 없는지 확인

- 물리 계층과 데이터 링크 계층은 서로 밀접하게 연관된 계층이고, 하드웨어와 밀접하게 맞닿아 있는 계층이다.

3. 네트워크 계층

- 네트워크 간 통신을 가능하게 하는 계층

- LAN을 넘어 다른 네트워크와 통신을 주고받기 위해 필요한 계층 -> 호스트를 식별할 수 있는 주소(IP 주소) 필요

- 네트워크 계층에서 대표적으로 사용되는 프로토콜 : IP 주소 

4. 전송 계층

네트워크를 통해 송수신되는 패킷은 전송 도중에 유실되거나 순서가 뒤바뀔 때도 있다.

- 위 상황을 대비해 신뢰성 있는 전송을 가능하게 하는 계층

- 포트(port)라는 정보를 통해 특정 응용 프로그램과의 연결 다리 역할을 수행하는 계층

- 전송 계층에서 대표적으로 사용되는 프로토콜 : TCP와 UDP


5. 세션 계층

- 응용 프로그램 간의 연결상태를 의미하는 **세션(session)**을 관리하기 위한 계층

- 응용 프로그램 간의 연결 상태를 유지하거나 새롭게 생성하고, 필요하다면 연결을 끊는 역할

6. 표현 계층

- 인코딩, 압축, 암호화와 같은 작업을 수행하는 계층 (번역가 역할)

7. 응용 계층

- 사용자와 가장 밀접하게 맞닿아 있어 여러 네트워크 서비스를 제공하는 계층

- 응용 계층에 속한 대표적인 프로토콜 : HTTP, HTTPS, DNS

**TCP/IP 모델**

<img width="1136" height="802" alt="image" src="https://github.com/user-attachments/assets/4ae889ca-6fc3-4c7e-be26-d18cb17e1077" />

1. 네트워크 액세스 계층

- 링크 계층, 네트워크 인터페이스 계층

- OSI 모델의 데이터 링크 계층과 유사

2. 인터넷 계층

- OSI 모델의 네트워크 계층과 유사

3. 전송 계층

- OSI 모델의 전송 계층과 유사

4. 응용 계층

- OSI 모델의 세션 계층, 표현 계층, 응용 계층과 유사
  
### 캡슐화와 역캡슐화

- 패킷을 송신하는 쪽에서는 상위계층에서 하위계층으로 정보를 보내고, 패킷을 수신하는 쪽에서는 하위 계층에서 상위 계층으로 정보를 받아들인다.

- 네트워크 계층 구조를 이용하면 프로토콜을 계층별로 구성할 수 있다.

- 하나의 패킷은 헤더와 페이로드(트레일러까지)를 포함하며, 프로토콜의 목적과 특징에 따라 헤더의 내용은 달라질 수 있다.

각 계층에서는 어떤 정보를 송신할 때,

상위 계층으로부터 내려받은 패킷을 페이로드로 삼아,

각 계층에 포함된 프로토콜의 각기 다른 목적과 특징에 따라 헤더 혹은 트레일러를 덧붙인 다음 하위 계층으로 전달한다.

-> 상위 계층의 패킷이 하위 계층의 페이로드로 간주된다.

- 캡슐화 : 송신 과정에서 헤더(및 트레일러)를 추가해 나가는 과정

- 역캡슐화 : 캡슐화 과정에 붙인 헤더(및 트레일러)를 각 계층에서 확인한 뒤 제거하는 과정

<img width="1000" height="462" alt="image" src="https://github.com/user-attachments/assets/ffbe8e2d-e42e-434c-8211-8bc04f13e3f7" />

<img width="2348" height="1674" alt="image" src="https://github.com/user-attachments/assets/e194a054-3ed5-4971-b537-e1414e325c41" />

<img width="1268" height="706" alt="image" src="https://github.com/user-attachments/assets/9c6dca70-9814-42c1-a5e0-86cb29c2fdb6" />

# 2. 물리 계층과 데이터 링크 계층

## 이더넷

이더넷 (Ethernet) :

- 통신 매체를 통해 신호를 송수신하는 방법, 데이터 링크 계층에서 주고받는 데이터(프레임) 형식 등이 정의된 기술

- IEEE 802.3이라는 이름으로 국제 표준화된 기술

- 현대 대부분의 (유선)LAN은 이더넷을 기반으로 구현되어 있다.

### 이더넷 표준

1. 오늘날의 (유선)LAN 대부분이 이더넷 표준을 따르기 때문에 대다수의 LAN 장비들이 특정 이더넷 표준을 따른다.

2. 이더넷 표준이 달라지면 통신 매체의 종류를 비롯한 신호 송수신 방법, 나아가 최대 지원 속도도 달라질 수 있다.

### 이더넷 프레임

이더넷 프레임 (Ethernet frame) :

- 이더넷 기반의 네트워크에서 주고받는 프레임

- 이더넷 프레임을 구성하는 5가지 요소

  <img width="1164" height="252" alt="image" src="https://github.com/user-attachments/assets/10a3c2ed-a411-4702-a21f-2e46143f0f23" />

  1. 프리앰블 (preamble)

    - 송수신지 동기화를 위해 사용되는 8바이트 크기의 정보
 
    - 수신자 입장에서는 프리앰블 비트를 통해 현재의 이더넷 프레임이 수신되는 걸 알아차림
 
  2. 송수신지 MAC 주소

    - 프레임에는 송신자와 수신자를 특정할 수 있는 6바이트 길이의 MAC 주소가 명시되며, 콜론(:)으로 구분된 12자리 16진수
 
    - MAC 주소 : 네트워크 인터페이스마다 하나씩 부여되는 주소
 
    - 네트워크 인터페이스 : 네트워크를 향하는 통로, 연결 매체와의 연결 지점
 
      - 보통 NIC라는 장치가 네트워크 인터페이스를 담당합니다.
     
      - NIC가 여러 개인 상황처럼 네트워크 인터페이스가 여럿이라면 한 호스트가 여러개의 MAC 주소를 가질 수 있습니다.
        
  3. 타입/길이

    - MAC 주소의 타입/길이 필드에 명시된 크기가 1500 이하 (16진수 05DC)이면 이 필드는 프레임의 크기를 나타내고,

      1536이상 (16진수 0600)이면 타입을 나타낸다.

    - 타입은 캡슐호된 상위 계층의 정보를 의미하기 때문에 타입을 통해 어떤 상위 계층 프로토콜이 캡슐화 되었는지를 알 수 있다.
 
  4. 데이터

    - 데이터 필드에는 페이로드, 즉 상위 계층으로 전달하거나 전달받을 데이터가 명시된다.
 
    - 데이터 필드에 포함될 수 있는 데이터의 최대 크기가 정해져 있다 -> **1500바이트** 이하로 제한
 
    - 1500 바이트보다 더 큰 데이터를 보내는 경우, 여러 패킷으로 나뉘어 보낸다.
 
    - **1500 바이트** : 이더넷 프레임으로 전송 가능한 최대 데이터의 크기
 
      - 네트워크 계층 패킷(헤더 + 페이로드)의 최대 크기를 지칭하는데 사용된다.
     
    - 점보 프레임 (jumbo frame) : 1500바이트보다 더 큰 데티러르 포함할 수 있는 프레임     
 
  5. FCS (Frame Check Sequence)
 
    - FCS = 트레일러
 
    - 프레임의 오류가 있는지의 여부를 확인하기 위한 필드로, CRC (Cyclic Redundancy Check)라는 오류 검출용 값이 명시된다.
 
    - 송신자에서 전송할 데이터와 더불어 전송할 데이터에 대한 CRC 값을 계산하여 보내면 

      수신지에서는 전달받은 데이터에 대한 CRC 값을 계산해, 그 값을 전달받은 CRC 값과 대조한다.

      -> 두 값이 같을 경우 프레임에 오류가 없다고 판단한다.

## 유무선 통신 매체

### 유선 매체 - 트위스티드 페어 케이블

  - 구리선을 통해 전기적으로 신호를 주고받는 통신 매체

  - 두 가닥씩 꼬아져 있는 구리선을 뜻한다.

  - 성능 구분 기준 (등급) : 카테고리 (Category)

    <img width="598" height="234" alt="image" src="https://github.com/user-attachments/assets/d6e2c083-2d3d-4552-8894-7e06a0180e63" />

  - 노이즈 (noise) : 전기 신호에 왜곡을 줄 수 있는 주변 잡음

    - 케이블을 그물 모양의 철사나 포일로 감싸 노이즈를 방지한다.
   
  - 차폐 (shielding) : 구리선 주변을 보호해 노이즈를 감소시키는 방식
  
    - 브레이드 실드 (braided shield) : 차폐에 사용된 그물 모양의 철사
   
    - 포일 실드 (foil shield) : 차폐에 사용된 그물 모양의 포일
   
    - STP 케이블 (Shielded Twisted Pair) : 브레이브 실드로 노이즈를 감소시킨 케이블

    - FTP 케이블 (Foil Twisted Foil) : 포일 실드로 노이즈를 감소시킨 케이블
  
### 무선 매체 - 전파와 WiFi

- 전파 : 약 3kHz부터 3THz 사이의 진동수를 갖는 전자기파

  - 유선 LAN에서 가장 대중적으로 사용되는 기술 : 이더넷
  
  - 무선 LAN에서 가장 대중적으로 사용되는 기술 : 와이파이
 
  - 와이파이에서 주로 사용되는 주파수 대역 : 2.4GHz 혹은 5GHz
 
  <img width="600" height="256" alt="image" src="https://github.com/user-attachments/assets/5cee3874-d9a7-48f9-9e19-fbe6378b9211" />

- 별개의 무선 네트워크는 같은 주파수 대역을 사용하더라도 서로의 신호에 간섭하지 않아야 한다.

  그래서 주파수 대역은 같은 대역을 사용하는 서로 다른 무선 네트워크를 구분하기 위해 

  채널 (channel) 이라는 하위 주파수 대역으로 세분화되고, 해당 채널 대역에서 무선 통신이 이루어진다.

- 무선 네트워크의 성능 저하를 방지하려면 신호가 중첩되지 않는 채널을 사용하는 것이 중요하다.

- AP (Access Point) : 여러 무선 통신 기기를 연결해 무선 네트워크를 구성하는 장비 ex) 무선 공유기

- SSID (Service Set Identifier) : 서비스 셋을 식별하는 정보, 와이파이 이름으로 사용되는 정보

## 네트워크 인터페이스 : NIC (Network Interface Controller)

- 네트워크 인터페이스 : 네트워크 상에서 노드와 통신 매체가 연결되는 지점, 노드와 네트워크 사이의 통로

- NIC : 컴퓨터가 네트워크와 통신할 수 있게 해주는 하드웨어 장치

  - 예) 네트워크 인터페이스 카드, 네트워크 어댑터, LAN 카드, 네트워크 카드, 이더넷 카드
  
- 통신 매체의 신호를 호스트가 이해하는 프레임으로 변환하거나 호스트가 이해하는 프레임을 통신 매체의 신호로 변환하는 역할을 수행한다.

- 때로는 MAC 주소를 토대로 잘못 전송된 패킷이 없는지 확인한다.

## 허브와 스위치

허브와 스위치 : 물리 계층과 데이터 링크 계층의 중간 노드

허브는 전이중/반이중 통신, 브로드 캐스트 통신의 특징을 잘 보여주는 네트워크 장비이다.

### 물리 계층의 허브

- 허브 : 물리 계층의 대표적인 네트워크 장비, 여러 대의 호스트를 연결하는 장치

  - 리피터 허브, 이더넷 허브
 
  - 포트 : 허브에서 케이블의 커넥터가 꽂히는 부분, 통신 매체를 연결하는 지점
 
- 허브의 2가지 특징

  1. 전달받은 신호를 모든 포트로 내보낸다.
 
  2. 반이중 모드로 통신한다.
 
   - 반이중 모드 : 송신 또는 수신을 번갈아 가면서 수행해야 하는 통신 방식.
   
     - 동시 수신이 불가능한 상태. ex) 무전기
 
   - 전이중 모드 : 동시 송수신이 가능한 상태 ex) 전화기 

     - 양방향 수신이 가능한 상태. 스위치는 전이중 모드 지원한다.
       
### 데이터 링크 계층의 스위치 

- 스위치 : 허브의 한계를 보완하기 위한 네트워크 장치

- 스위치는 허브와 달리 전달받은 신호를 목적지 호스트가 연결된 포트로만 내보내고, 

  전이중 모드를 지원하므로 허브와 비교해 콜리전 도메인이 좁다.

- 스위치가 전달받은 신호를 원하는 포트에만 내보낼 수 있는 이유 :

  - 스위치에 MAC 주소 학습 기능이 있기 때문 (MAC 주소 테이블을 생성하고 참조할 수 있기 때문)
 
  - 스위치는 프레임 속 MAC 주소를 토대로 현재 어떤 포트에 어떤 MAC 주소를 가진 호스트가 연결되어 있는지 파악하고,

    '포트, 연결된 호스트의 MAC 주소'의 대응 관계를 테이블의 형태로 메모리에 저장 -> MAC 주소 테이블

- VLAN (Virtual LAN): 가상의 LAN

  - 같은 스위치에 연결된 모든 호스트를 하나의 네트워크로 간주하고 싶지 않을 때, 여러 논리적인 네트워크로 나누고 싶을 때 사용된다.     


